<section class="content">
    <div class="content-block">
        <div class="block-header">
            <!-- breadcrumb -->
            <app-breadcrumb [title]="'Appointments'" [items]="[]" [active_item]="'Appointments'"></app-breadcrumb>
        </div>
        <div class="row clearfix">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <div class="card">
                    <div class="body">
                        <div class="">
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="ngxTableHeader">
                                        <ul class="header-buttons-left ms-0 mb-0">
                                            <li class="dropdown">
                                                <h2><strong>Appointments</strong></h2>
                                            </li>
                                            <li>
                                                <mat-form-field class="example-full-width searchInput"
                                                    appearance="outline">
                                                    <mat-label>Filter</mat-label>
                                                    <input matInput (keyup)="applyFilter($event)" placeholder="Search"
                                                        autocomplete="off">
                                                </mat-form-field>
                                            </li>
                                        </ul>
                                        <ul class="header-buttons">
                                            <li>
                                                <button mat-raised-button color="primary" type="button"
                                                    [routerLink]="['/patient/book-appointment/radio-add-appointment/'+id]">Book
                                                    Appointment</button>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="card-body p-0">
                                        <div class="body table-responsive pdf_sign">
                                            <table mat-table [dataSource]="dataSource3" class="w-100" matSort
                                                #empTbSort="matSort">
                                                <!-- No Column -->
                                                <ng-container matColumnDef="no">
                                                    <th mat-header-cell *matHeaderCellDef mat-sort-header> S.No. </th>
                                                    <td mat-cell *matCellDef="let element; let i = index;"> {{ i + 1 }}
                                                    </td>
                                                </ng-container>

                                                <ng-container matColumnDef="id">
                                                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Booking ID
                                                    </th>
                                                    <td mat-cell *matCellDef="let element; let i = index;"> {{
                                                        element.id}}
                                                    </td>
                                                </ng-container>
                                                <!-- No Column -->
                                                <ng-container matColumnDef="lab_name">
                                                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Radiology Name
                                                    </th>
                                                    <td mat-cell *matCellDef="let element">

                                                        {{element.lab_name}}
                                                    </td>
                                                </ng-container>
                                                <ng-container matColumnDef="lab_address">
                                                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Radiology
                                                        Address
                                                    </th>
                                                    <td mat-cell *matCellDef="let element">

                                                        {{element.lab_address??'-'}}
                                                    </td>
                                                </ng-container>
                                                <!-- Name Column -->
                                                <ng-container matColumnDef="test_name">
                                                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Test Name
                                                    </th>
                                                    <td mat-cell *matCellDef="let element; let i = index ;">
                                                        <!-- <div *ngFor="let testfinal of element.cart_item">
                                                            {{testfinal.test_name+','}}
                                                        </div> -->
                                                        <div *ngFor="let testfinal of element.cart_item">
                                                            {{( element.cart_item && element.cart_item.length > 1) ? testfinal.test_name+',' : testfinal.test_name}}
                                                        </div>
                                                    </td>
                                                </ng-container>
                                                <!-- Name Column -->
                                                <ng-container matColumnDef="first_name">
                                                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Appointment
                                                        For
                                                    </th>
                                                    <td mat-cell *matCellDef="let element">
                                                        {{element.first_name}}
                                                    </td>
                                                    <!-- <td mat-cell *matCellDef="let element">
                                                        {{element.first_name??'-'}}
                                                    </td> -->
                                                </ng-container>
                                                <!-- Name Column -->
                                                <ng-container matColumnDef="grand_total">
                                                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Amount
                                                    </th>
                                                    <td mat-cell *matCellDef="let element">
                                                        &#8377; {{element.grand_total}}
                                                    </td>
                                                </ng-container>
                                                <!-- Name Column -->
                                                <ng-container matColumnDef="doctor">
                                                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Referred By
                                                    </th>
                                                    <td mat-cell *matCellDef="let element">
                                                        {{element.doctor??'-'}}
                                                    </td>
                                                </ng-container>
                                                <!-- Name Column -->
                                                <ng-container matColumnDef="appointments_user_type">
                                                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Appointment
                                                        By
                                                    </th>
                                                    <td mat-cell *matCellDef="let element">
                                                        {{element.appointments_user_type}}
                                                    </td>
                                                </ng-container>
                                                <ng-container matColumnDef="appointment_date">
                                                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Date
                                                    </th>
                                                    <td mat-cell *matCellDef="let element">
                                                        {{element.appointment_date | date: 'dd/MM/yyyy'}}
                                                    </td>
                                                </ng-container>
                                                <ng-container matColumnDef="time_slot">
                                                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Time Slot
                                                    </th>
                                                    <td mat-cell *matCellDef="let element">
                                                        {{element.time_slot}}
                                                    </td>
                                                </ng-container>

                                                <ng-container matColumnDef="payment_status">
                                                    <th mat-header-cell *matHeaderCellDef> Payment Status </th>
                                                    <td mat-cell *matCellDef="let element">
                                                        <span
                                                            class="badge badge-{{element.payment_status=='Success'?'Completed':element.payment_status}}">
                                                            {{(element.payment_status == 'Successful' ||
                                                            element.payment_status == 'Success') ? "Success": (
                                                            (element.payment_status == 'Pending') ? "Pending" : (
                                                            (element.payment_status == 'Aborted') ? "Failed" : ""))
                                                            }}</span>
                                                    </td>
                                                </ng-container>
                                                <ng-container matColumnDef="reason_of_reschedule">
                                                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Reason of
                                                        Reschedule
                                                    </th>
                                                    <td mat-cell *matCellDef="let element">
                                                        {{element.reason_of_reschedule!='' &&
                                                        element.reason_of_reschedule!=null?element.reason_of_reschedule:'-'
                                                        }}
                                                    </td>
                                                </ng-container>
                                                <!-- Document Column -->
                                                <ng-container matColumnDef="dcm_document" matSortDisabled>
                                                    <th mat-header-cell *matHeaderCellDef> Reports</th>
                                                    <td mat-cell *matCellDef="let element">
                                                        <!-- <a class="imgSizeIcon" href="" target="__blank"
                                                            (click)="viewReport(element.dcm_document_url??'-')">
                                                            {{element.dcm_document_url ?
                                                            viewDicomFile(element.dcm_document_url??"-") : "-"}} <div
                                                                [innerHtml]="htmlReturn"></div> </a>

                                                        <a class="imgSizeIcon" href="{{element.report_documentApk}}"
                                                            target="_blank" [style.pointer-events]="isDisable">

                                                            {{returnPdfradio(element.report_documentApk?element.report_documentApk:
                                                            element.pdf??'-')}}
                                                            <div [innerHtml]="htmlReturn">
                                                            </div>
                                                        </a> -->
                                                        <div>
                                                            <span>
                                                              <a class="imgSizeIcon"
                                                                *ngIf="((element.dcm_document_url != null && element.dcm_document_url != '') ? true : false)"
                                                                target="__blank" href="{{element.dcm_document_url}}">
                                                                {{element.dcm_document_url ? viewDicomFile(element.dcm_document_url??'-') : '-'}} <div
                                                                  [innerHtml]="htmlReturn"></div> </a>
                                                            </span>
                                                            <span>
                                                              <a class="imgSizeIcon"
                                                                *ngIf="((element.report_documentApk != null) ? true : false)"
                                                                href="{{element.report_documentApk}}" target="_blank">
                                                                {{element.report_documentApk ? returnPdf(element.report_documentApk??'-') : '-'}} <div [innerHtml]="htmlReturn">
                                                                </div> </a>
                                                            </span>
                                    
                                                          </div>
                                                    </td>
                                                </ng-container>
                                                <!-- <ng-container matColumnDef="report_document">
                                                    <th mat-header-cell *matHeaderCellDef class="p-3"> Report </th>
                                                    <td mat-cell *matCellDef="let element">
                                                        <a class="imgSizeIcon"
                                                            href="{{element.report_document?imageURL+element.report_document: '-'}}"
                                                            target="_blank" (click)="viewReport(element.report_document??'-')
                                                          ">
                                                            {{viewDicomFile(element.report_document??'-')}} <div
                                                                [innerHtml]="htmlReturn"></div> </a>
                                                    </td>
                                                </ng-container> -->
                                                <!-- Status Column -->
                                                <ng-container matColumnDef="appointment_status">
                                                    <th mat-header-cell *matHeaderCellDef> Appointment Status </th>
                                                    <td mat-cell *matCellDef="let element">
                                                        <label class="badge col-{{element.appointment_status??'-'}}">
                                                            {{element.appointment_status??'-'}}

                                                        </label>
                                                        <div class="payNowBtn" *ngIf="(element.payment_status) == 'Successful' ||
                                                            (element.payment_status == 'Success') ? false : true">
                                                            <button mat-stroked-button color="primary"
                                                                (click)="open(mymodal);getPaymentUrl(element.url);"
                                                                *ngIf="(element.appointments_user_type) == 'doctor'? true : false">Pay
                                                                Now</button>
                                                        </div>
                                                    </td>
                                                </ng-container>
                                                <ng-container matColumnDef="shareReport" matSortDisabled>
                                                    <th mat-header-cell *matHeaderCellDef> Share Pdf Report</th>
                                                    <td mat-cell *matCellDef="let element">
                                                        <button mat-icon-button [matMenuTriggerFor]="menu2"
                                                            *ngIf="(element.appointment_status == 'Visited' || element.appointment_status == 'Approved')  && element.report_document!='' && element.report_document!=null   ? true : false "
                                                            aria-label="Example icon-button with a menu">
                                                            <mat-icon>more_vert</mat-icon>
                                                        </button>
                                                        <mat-menu #menu2="matMenu">
                                                            <share-buttons [theme]="'material-dark'"
                                                                [include]="['whatsapp']"
                                                                [url]="imageURL+element.report_document"
                                                                [image]="'https://www.eduforbetterment.com/wp-content/uploads/2020/08/qrcode.jpg'"
                                                                [autoSetMeta]="true">
                                                            </share-buttons>
                                                            <share-buttons [theme]="'material-dark'"
                                                                [include]="['email']"
                                                                [url]="imageURL+element.report_document"
                                                                [image]="'https://www.eduforbetterment.com/wp-content/uploads/2020/08/qrcode.jpg'"
                                                                [autoSetMeta]="true">
                                                            </share-buttons>
                                                            <share-buttons [theme]="'material-dark'"
                                                                [include]="['telegram']"
                                                                [url]="imageURL+element.report_document"
                                                                [image]="'https://www.eduforbetterment.com/wp-content/uploads/2020/08/qrcode.jpg'"
                                                                [autoSetMeta]="true">
                                                            </share-buttons>
                                                        </mat-menu>
                                                    </td>
                                                </ng-container>
                                                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                                                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                                            </table>
                                            <mat-paginator [pageSizeOptions]="[10, 20,25]" showFirstLastButtons>
                                            </mat-paginator>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <ng-template #mymodal let-modal>
        <div class="modal-header">
            <h4 class="modal-title" id="modal-basic-title">Payment Confirmation</h4>
            <!-- <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
            <span aria-hidden="true">Ã—</span>
          </button> -->
        </div>
        <div class="modal-body">
            Are you sure you want continue payment process?
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-outline-dark"
                (click)="modal.close('Save click'); addpaymentbyUrl()">Yes</button>

            <button type="button" class="btn btn-outline-dark" (click)="modal.dismiss('Cross click')">Cancel</button>
        </div>
    </ng-template>
</section>